[TOC]

# Tema 03: Directorios



## 1. Navegaci√≥n

üìñ **Path**

> Ruta que indica la ubicaci√≥n de un archivo o carpeta.

üìñ **Path Absoluto**

> Un path desde la ra√≠z de la unidad de almacenamiento. Comienzan con `/`

üìñ **Path Relativo**

> Un path desde el lugar donde se consulta. Comienzan sin `/` o con `./`

Pongamos un ejemplo.

```bash
# Estructura de directorios
|--folderA
|  |--docuA.txt
|  |--docuB.txt
|
|--folderPNG
   |--picA.png
   |--picB.png
   |--folderJPG
      |--picA.jpg
      |--picB.jpg
```

Imagina que estamos en el terminal dentro de la carpeta folderJPG.

```bash
# Path absoluto de docuB.txt
/folderA/docuB.txt
# Path relativo de docuB.txt
./../../folderA/docuB.txt
../../folderA/docuB.txt
```

- `./` indica la carpeta actual.
- `../` sirve para indicar la carpeta anterior.
- `~/` indica la carpeta home del usuario.



Ha continuaci√≥n se muestra una serie de comandos relacionados √∫tiles

#### cd

Permite navegar en la estructura de directorios.

En el ejemplo anterior si estamos en folderPNG y quisieramos ir a docuB.txt o picB.jpg

```bash
# Usando path relativos
cd ./../folderA/docuB.txt
cd folderJPG

# Usando path absoluto
cd /folderA/docuB.txt
cd /folderPNG/folderJPG/picB.jpg
```

#### ln

Para lista el contenido de una carpeta. Puede tener las siguientes opciones

- `-l` mostrar el resultado en una lista
- `-d` ver solo directorios
- `-a` ver archivos ocultos
- `-s` tama√±o de ficheros

#### nano

No es un comando, es un peque√±o editor de texto por consola. Como vamos ha hacer pr√°cticas de navegaci√≥n por ficheros, listaremos y veremos el contenido de ficheros. Todo por terminal, como los pro üòâ

#### cat

Muestra por terminal el contenido de un fichero.

```bash
ls -la / > listado.txt
cat listado.txt
```

Gracias a `>` guardamso en un fichero el resultado del comando. Luego con `cat` lo vemos por pantalla.



## 2. Comandos de Archivos

#### touch

- Crear archivos

```bash
touch prueba.txt
```



#### mkdir

- Crear carpetas

```bash
mkdir pruebaFolder
```



#### rm

- Borra archivos o directorios. Para borrar directorios y el contenido que tiene dentro hay que usar las opciones.
  - `-d`: Borra directorios.
  - `-r`: Borra todo lo que hay dentro de la carpeta.

```bash
rm prueba.txt
rm -dr folder01
```



#### cp

- Copiar archivos o directorios. Primero se indica el origen y luego el destino.
  - `-r`: Copia todo lo que hay dentro de la carpeta

```bash
cp ./folder_src/pic.jpg ./folder_dest
cp -r ./folder_src ./folder_dest
```



#### mv

Mover ficheros. Primero se indica el origen y luego el destino

```bash
mv ./folder_src/pic.jpg ./folder_dest
mv ./folder_src ./folder_dest
```

Tambi√©n es usado para renombrar ficheros

```bash
mv mv ./pic.jpg ./pic-renamed.jpg
```



#### ln

Para crear accesos directos a archivos o carpetas. Hay de dos tipos, simbolicos y duros. No nos vamos a entretener en sus diferencias, ya que se comprenden mejor cuando veamos los sistemas de archivos. De momento aprendamos ha ahcer simb√≥licos

```bash
ln -s ./path_src_file/test.txt linkTest
```





## 3. B√∫squedas 

Una de las tareas habituales en un administrador es buscar informaci√≥n en logs, informes o salidas de comandos. 



#### find

Permite buscar archivos y carpetas. Primero indicamos la carpeta donde buscar. Si queremos hacer una b√∫squeda en todo el sistema empezamos desde la raiz `/`. Si solo queremos desde el path actual en la terminal `.` 

```bash
find / -name "patata"
```



‚ö†Ô∏è **¬°Atenci√≥n!**

> Para GNU/Linux tiene en cuenta las may√∫sculas y min√∫sculas en los nomrbes de fichero. No es lo mismo `patata.txt`, `PATATA.txt` o `pATaTa.txt`.



‚≠ê **Expresiones Regulares**

> Normalmente en las b√∫squedas no suamos cadenas exactas, sino expresiones regulares o tambi√©n llamadas regex. San bastante arduas de aprender. Hay algunas p√°ginas como RegexR para aprender y pr√°cticar. A parte de proporcionar un cheatsheet, tenemos un peque√±o editor. Con √©l poemos comprobar la regex creada, incluso hace un an√°lisis de su funcionamiento.
>
> Vamos a ver algunos ejemplos:
>
> | Regex        | Explicaci√≥n                                       | Ejemplo    |
> | ------------ | ------------------------------------------------- | ---------- |
> | `\w*`        | Cualquier cadena                                  | `gatos206` |
> | `\d*`        | Solo cadenas de n√∫meros                           | `5168498`  |
> | `[a-zA-z]*`  | Solo cad√©nas con letras                           | `gatos`    |
> | `^(pa)(ta)$` | Cadenas que comiencen con 'pa' y terminen en 'ta' | `patata`   |



**Opciones**

- `-name`: Buscar por nombre case sensitive. Podemos usar expresiones regulares.
- `-iname`: Buscar por nombre no case sensitive. Podemos usar expresiones reulares.
- `-not`: Se antepone a otras opciones para indicar que descarte esa coincidencia.
- `-type`: Pueden ser
  - `f`: Fichero
  - `d`: Directorio
  - `l`: Enlace

- `-size`: La unidad sigue la siguiente nomenclatura

  - `c`: Byte
  - `k`: Kilobyte
  - `M`: Megabyte
  - `G`: Gigabyte

  Tambi√©n nos ayudamos de los simbolos `-` y `+` para indicar que busque por encima o por debajo del tama√±o. Si no se indica busca exactamente ese tama√±o.

- `-maxdepth` y `mindepth`: Si buscamos en un directorio con uan estructura profunda de carpetas, podemos indicar "hasta" o "a partir" de que nivel.

Para los logs es interesante las fechas. Usamos estos prefijos para diferenciar el uso de √©stas:

- `-a`: La ultima vez que se escribi√≥ o ley√≥.
- `-m`: La √∫ltima vez que se modific√≥ el contenido.
- `-c`: La √∫ltima vez que se modificaron los metadatos.

A estos prefijos les sigue uno de las siguientes palabras:

- `time`: N¬∫ de d√≠as.
- `min`: N¬∫ de minutos.

Otras opciones relacionadas con los usuarios son:

- `-user`: nombre de usuario.

- `-group`: grupo.

- `-perm`: permisos expresados por n√∫mero.

  

**Ejemplos**

- Buscar archivos que contienen la palabra "patata". Han de ser mayores de 3 Kilobytes. tambi√±en que hayan sido escritos o leidos hace un d√≠a.
- Buscar en el path actual los ficheros que comiencen por 'pa'. Han de pertenecer al usuario "kodeneko". Su tama√±o ha de ser menor de 1G.

```bash
find / -name "patata" -type f -size +3k -atime 1
find . -name '(patata.*)$' -user kodeneko -size -1G
```



#### grep

Permite buscar una cadena por cada linea. Las b√∫squedas pueden ser resultados de comandos o ficheros de texto.

```bash
ls -la | grep "perico"
cat ./log.txt | grep "error"
```

El s√≠mbolo `|` es una "pipe". Permite que la salida de un programa sea la entrada para otro. Son muy potentes, desde mi punto de vista dominarlos es lo que separa a un "super pro" de un "pro".

Tabi√©n podemos decir que no busque por una cadena usando -v. Por ejemplo no queremos del log ver los mensajes "warning".

```bash
cat ./log.txt | grep -v "warning"
```



#### cut

Con `grep` tenemos lineas, pero en ocasiones queremos de esa linea un segmento. Podemos con `cut` hacerlo. Existen bastante opciones pero lo normal es usar el comando con estas opciones:

- `-d`: Especificar un delimitador.
- `-f`: Con el delimitador divide la linea por segmentos. Con esta opci√≥n indicarmos cual mostrar.

Para el ejemplo vamos a visualizar el fichero /etc/passwd, una lista de los usuarios del sistema. Cada linea es un usuario de la forma `unicorn:x:1000:1000:unicorn,,,:/home/unicorn:/bin/bash`. Imagina que solo queremos una lista de nombres.

```bash
sudo cat /etc/passwd | cut -d ":" -f1 
```

El delimitador de la linea es el s√≠mbolo ":". De todos los segemento el primero es elq ue contiene el nombre



## 4. Otros comandos

#### clear

Limpia la pantalla de la terminal

#### exit

Cierra la pantalla de terminal

#### date

Muestra la fecha en formato ISO

#### reboot

Reinicia el equipo

#### man

Permite consultar la documentaci√≥n del comando. Por ejemplo no sabemos como mostrar usando `ls` el listado de archivos y directorios. Escribiendo `man ls` nos aparece por terminal el manual completo. 

Esta documentaci√≥n est√° disponible en muchas webs. Como es denso es recomendable hacer uso del manual a trav√©s del navegador. Dispones de mejores opciones de b√∫squeda. Por terminal es para sacarte de un apuro.



## 5. Jerarqu√≠a del Sistema de Archivos

La comunidad GNU/Linux ha ido definiendo la estructrua de directorios del sistema. Incluso podemos ver modificaciones en distintas distribuciones. Tambi√©n se la conoce como Filesystem Hierarchy (FSH). Conocerla nos quita muchos quebraderos de cabeza. A veces queremos buscar los archivos de un programa, o bien realizar una instalaci√≥n. Su desconocimiento dificulta mucho √©stas labores.

**FHS**

> Norma de estcruturaci√≥n de carpetas del sistema de GNU/LInux. No es un est√±andar estricto. Diversas distros a√±aden sus variaciones. 



#### /

- El punto de inicio de toda la estructrua de directorios.
- Se le llama ra√≠z.



#### /dev

- Los dispositivos HW los representa Linux como archivos.
- En esta carpeta podemos encontrarlos todos.
  - `sd[x]`: Representa una unidad de almacenamiento. Pueden ser tanto interna como externa. No se incluyen los lectores de discos. La x se sustituye por letras de la a-z. Si hay 2 discos duros y una memoria USB, son nombrados como `sda`, `sdb` y `sdc`.
  - `cdrom`: El dispositvo CDROM.
  - `audio`: La tarjeta de audio.



#### /mnt

- Para poder usar un dispositivo de almacenamiento hay que montarlo.
- Cuando est√° montado aparece en esta carpeta.
- HDD - SSD



#### /media

- Para poder usar un dispositivo √≥ptico hay que montarlo
- Cuando est√° montado aparece en esta carpeta
- CD, DVD, BluRay, USB...



#### /home

- Contiene una carpeta por usuario.

- Hay diversos usuarios que son propios del sistema, como root. Estos no tienen carpeta en home.

- Alojan los archivos personales del usuario.

- Tambi√©n las configuraciones de las aplicaciones para ese usuario.

  

#### /root

- En linux el usuario con mayor privilegios es llamado "root".
- Es su carpeta personal, como las que hay en `/home` para cada usuario.
- Podemos acceder al sistema con root, pero no es recomendable. Si por alg√∫n motivo se corrompe deja inservible el sistema por completo. Para ello se crean usuarios con privilegios de "superusuario". Tambi√©n reciben el nombre de "sudoer"
- En priemr usuario que creas en la instalaci√≥n es un sudoer. Hay diversas aplicaciones que para ejecutarlas necesitas anteponer "sudo" en el terminal. Aparece en el prompt el aviso de introducir su contrase√±a. En GNU/Linux se toman en serio la seguridad a√±adiendo esta capa.



#### /bin

- Almacena binarios ejecutables del sistema.
- Podemos encontrar los binarios de los comandos del terminal como `cp`, `echo`, `cat`, `mv`, `rm`...
- Solo contiene archivos, no hay carpetas..



#### /sbin

- Tiene el mismo prop√≥sito que /bin
- En este caso son binarios del sistema ejecutados por superusuarios
- Entre ellos encontramos `fsck`, `shutdown`, `fastboot`...



#### /usr

- Contiene los programas que no son del sistema
- Los paquetes de las distro que se incluyen en la instalaci√≥n van generalmente aqu√≠. No es lo mismo una herramienta propia del sistema que los paquetes. A veces esta linea puede ser tenue.
- Subdirectorios
  - `/usr/bin`: Los ejecutables.
  - `/usr/include`: Archivos de cabecera.
  - `/usr/lib`: Bibliotecas compartidas. Tambi√©n ficheros que solo pueden ejecutar superusuarios.
  - `/usr/local`: Puede que nuestro usuario no este "f√≠sicamente" en nuestro ordenador. Accedamos a √©l a trav√©s de un servidor. Por tanto el contenido de la carpeta /usr no lo tenemos. Pero tenemos /usr/local para instalar fisicamente programas. 
  - `/usr/sbin`: Binarios que solo peuden ser ejecutados por superusuarios.
  - `/usr/share`: Documentaci√≥n de los programas.
  - `/usr/src`: El c√≥digo fuente de las aplicaciones.



#### /etc

- Incluye archivos de configuraci√≥n.

- Pueden ser del sistema o de otros programas.

- Subdirectorios.

- - `/etc/apt`: Configuraci√≥n del gestor de paquetes apt.

  - `/etc/opt`: Configuraci√≥n de programas de las carpetas de /opt.

  - `/etc/profile`: Configuraci√≥n de usuarios para iniciar el terminal.

    

#### /lib

- Contiene bibliotecas para los ejecutables de las carpetas `/bin` y `/sbin`.
- Tambi√©n m√≥dulos del kernel y drivers. Aquellos necesarios durante el arranque.



#### /var

- Variables o archivos temporales.

- Por ejemplo logs u otros registros.
  - `/var/cache`: Para cacheo. Por ejemplo apt-get lo usa como cache de paquetes descargados.
  - `/var/lib`: Info sobre ele stado de aplicaciones.
  - `/var/log`: Logs!
  - `/var/opt`: Variables de programas en /opt
  - `/var/tmp`: Temporales



#### /opt

- Para programas que no siguen el est√°ndar de carpetas de linux



#### /boot

- Incluye archivos usados en el arranque del equipo.

- No incluye archivos de configuraci√≥n.

- Est√° ubicado el kernel y el gestor de arranque.

  

#### /srv

- Para aplicaciones servidor
- Guarda directorios y datos
- Por ejemplo apache



#### /tmp

- Archivos temporales
- Tambi√©n algunas variables para el funcionamiento de programas
- Se supone que esta se vacia cuando reiniciamos. 



#### /sys

- Informaci√≥n sobre el kernel, particiones, sistema de archivos, drivers...
- No tocarlo mucho üòÖ



----



## üé≤ Ejercicios

- [Test de Comandos](https://pregunta2.com/quiz/d9e42377)
- [Test de Estructura de Directorios](https://pregunta2.com/quiz/d48637d7)
- Vamos a hacer una serie de operaciones con el terminal. Todos los comandos que uses los guardar√°s en un documento .txt para entregarlo. Para ello descargamos la siguiente carpeta. Abrimos un terminal en ella y realizaremos lo siguiente:

  - Listar la subcarpeta "pics". Incluir su resultado en un fichero llamado "list-pics.txt". Usa el comando `>` para ello.

  - Buscar dentro de "list-pics.txt" las im√°genes que comiencen por "animal". El resultado guardarlo en un fichero llamado "lis-animal-pics.txt".

  - Crear una carpeta llamada "future-delete".

  - Copiar el contenido de la carpeta "logs" a "future-delete". ¬°Cuidado! contiene subcarpetas.

  - Renombrar la carpeta "test" a "nosense". 



## üìï Bibliograf√≠a

- Estructura de directorios en Gnu-Linux
  https://geekland.eu/estructura-de-directorios-en-linux/
- ¬øC√≥mo crear enlaces simb√≥licos y duros en GNU/Linux?
  https://www.raulprietofernandez.net/blog/gnu-linux/como-crear-enlaces-simbolicos-y-duros-en-gnu-linux
- Linux man pages online
  https://man7.org/linux/man-pages/index.html
- C√≥mo usar Find y Locate para buscar archivos en Linux
  https://www.digitalocean.com/community/tutorials/how-to-use-find-and-locate-to-search-for-files-on-linux-es
- RegexR
  https://regexr.com/